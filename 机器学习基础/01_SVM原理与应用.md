# SVM原理与应用

## 问题

只知道是做分类用的，课上也学过，但就是没领悟其精华，这里就争取下吧！

## 什么是支持向量

假设我们要判断一个人是否得癌症,比如下图：红色得癌症,蓝色不得.

<img src="https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/583030-20190117161658759-1812646108.png" alt="img" style="zoom:67%;" />



看一下上图,要把红色的点和蓝色的点分开,可以画出无数条直线.上图里黄色的分割更好还是绿色的分割更好呢？直觉上一看,就是绿色的线更好.对吧.

为啥呢？考虑下图,新来了一个黑色点,明显靠蓝色点更近,如果用黄线分割,却把它划分到了红色点这个类别里.

<img src="https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/583030-20190117161825022-2070244299.png" alt="img" style="zoom:67%;" />

现在细想一下为什么绿线比黄线分隔效果更好？

- 黄色线太贴近蓝色点
- 绿色线到红色点群和蓝色点群距离大致相等.恰好位于两个点群中间的位置

由此我们就引申出了SVM的理论基础：**使得距离决策边界最近的点的距离之和最远**.  我屮艸芔茻,纳尼？？这都是啥. 别慌,看下图：

<img src="https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/583030-20190117164239606-1852715437.png" alt="img" style="zoom:67%;" />

还是上面的问题,什么样的分隔线才是最好的？答案是上图中的绿色线条C.  

1. 线条A平行于C平行于B.  
2. d代表距离C最近的点到C的距离.
3. margin代表A到B的距离,margin=2d.

**我们想寻找的最优分割线其实就是使得margin最大,margin最大意味着红色点和蓝色点被尽可能的分开了.**同时这个分隔线又得不偏不倚,既不偏向红点,也不偏向蓝点, **所以C是A，B正中间的线.**

也就是说,A穿过的两个红点和B穿过的蓝点决定了C的位置**.我们把其称为支撑向量.  这也是SVM叫做支撑向量机算法的由来**.

## 硬间隔SVM

假设数据是线性可分的,则我们找得到一条线将数据一分为二.这种情况下我们称之为hard margin svm。

上图中的C在二维空间(即平面)中是一条线. 推广到N维空间中,是一个N-1维的超平面.我们把这个超平面定义为$w^Tx + b = 0$。则任意一点到该超平面的距离为$frac {|w^Tx+b|} {||w||^2}$ 。

 ```用二维平面上点(x,y)到直线ax+by+c=0的距离去思考一下,高维空间就别想象了,毕竟人类这种生物是无法理解超过三维空间的)``

超平面上方,红球的label我们定义为y =1,超平面下方,蓝色球的label定义为y=-1.(和逻辑回归一样,SVM本身只能解决二分类问题,当然我们可以通过不断SVM的方式以达到解决多分类的问题,这里略去不表.) 则对任意球,到这个超平面距离都大于d。

在分隔平面上方,$w^Tx^i + b$ > 0, y=1,在分隔平面下方，$w^Tx^i + b$ < 0, y=-1。所以我们有：

$$y^i frac{w^Tx^i + b} {||w||^2} ge d$$,可以转换为 $$y^i frac{w^Tx^i + b} {d||w||^2} ge 1$$. $d||w||^2$是一个标量,所以可以改写成

$$y^i(w_d^Tx^i + b_d)ge 1$$为了表示的方便,记为$$y^i(w^Tx^i + b) ge 1$$

所以可得下图所示：

![img](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/583030-20190117203556615-1771067668.png)

对于任意的支撑向量$x^i$而言,$d=frac {|w^Tx^i + b|} {||w||^2} = frac 1{||w||^2}$。我们的目标是最大化margin，也就是最大化d，也就是最小化$||w||$。实际中,为了求导的方便,通常转换为最小化$frac 1 2 ||w||^2$

从而我们的svm的求解转换为一个限定条件下的最优化问题.

$$ left{egin{aligned}  {min frac 1 2 ||w||^2 \  S.T. y^{(i)}(w^T x^{(i)} + d) ge 1}  end{aligned} ight.$$

限定条件下的最优化问题要比全局最优化问题背后的数学推导复杂太多了,不在本篇说明了。以上,我们基本理解了svm的原理.