# C++学习笔记

**写在前头：**

1.所有语法都是遵循编译器的规则

2.编译器就是程序员和机器之间的单向翻译官，把我们的话（高级编程语言）翻译成机器能执行的指令（机器语言）。

## 一. 了解编译器

### 1.1 简介

编译就是把高级语言翻译成机器语言(二进制字符)

Linux系统中用gcc/g++ 去编译C/C++, 当然g++ 专门针对c++的

用gcc 编译C++代码:

```
gcc main.cpp -lstdc -o main						
```

用g++ 编译C++最简单方式：

```c++
g++ mian.cpp
```

使用-o 指定可执行文件的文件名，不然都叫a.out

```c++
g++ main.cpp -o main
```

### 1.2 常用命令选项

注:只记录我见过和用过的，陆续补充

| 选项      | 解释                          |
| --------- | ----------------------------- |
| -o        | 生成指定文件名的输出文件      |
| -c        | 只编译生成目标文件            |
| -E        | 只运行C编译器                 |
| -lLIBRARY | 连接时搜索指定函数库的LIBRARY |

### 1.3 编译过程（待补充）

了解这个过程发生了什么，什么输入，什么输出

## 二、数据类型

主要介绍数据空间分配及生命周期

### 2.1 基本数据类型

C++ 共有七种**基本**数据类型, 目的是为变量分配内存空间，所以说以下各种类型唯一区别是所占用的内存空间大小不同，那为啥要分这么多呢？可能是针对不同类型数据特性吧。那为啥不让机器自己识别呢？所以python做的比较智能化，不需声明变量类型。

| 类型     | 关键字  | 位      |
| -------- | ------- | ------- |
| 布尔型   | bool    | 1字节   |
| 字符型   | char    | 1字节   |
| 整形     | int     | 2-8字节 |
| 浮点型   | float   | 4字节   |
| 双浮点型 | double  | 8字节   |
| 无类型   | void    |         |
| 宽字符型 | wchar_t | 2-4字节 |

以上七种基本类型还可以使用一个或多个类型修饰符进行修饰（空间大小有细分了），这下类型至少有28种了：

- signed  带符号（有正负）
- unsigned   不带符号
- short  
- long

注：不同系统会有所差异，一字节为 8 位

注：默认情况下，int、short、long都是带符号的，即 signed

**常见操作：**

1. 可以用**sizeof**(类型) 查询当前类型或变量所占用的空间

2. 可以使用 **typedef** 为一个已有的类型取一个新的名字：

   ```
   typedef int feet;
   ```

   其实wchar_t 是这样来的：

   ```
   typedef short int wchar_t;
   ```

   

### 2.2. 变量类型

####  简介与分类

变量其实只不过是程序可操作的存储区的名称。C++ 中每个变量都有指定的类型，类型决定了变量存储的大小和布局，该范围内的值都可以存储在内存中，运算符可应用于变量上

![image-20220430211544706](C:\Users\10428\AppData\Roaming\Typora\typora-user-images\image-20220430211544706.png)

C++ 也允许定义各种其他类型的变量，比如**枚举、指针、数组、引用、数据结构、类**等等， 可见变量类型并没有那么狭隘，甚至一个类都可以叫一个变量。

#### 变量定义

变量定义就是告诉编译器在何处创建变量的存储，用多大的空间。

![image-20220430212159334](C:\Users\10428\AppData\Roaming\Typora\typora-user-images\image-20220430212159334.png)

变量定义指定一个数据类型，并包含了该类型的一个或多个变量的列表，例如：

```
int    i, j, k;
```

变量可以在声明的时候被初始化（指定一个初始值) 

```
int d = 3, f = 5;    
```

不带初始化的定义：带有静态存储持续时间的变量会被隐式初始化为 NULL（所有字节的值都是 0）。

####  变量声明

可以使用 **extern** 关键字在任何地方声明一个变量。

变量声明是向编译器保证变量会下以当前给定的类型和名称存在（提前告诉编译器一声我要来），这样编译器在不需要知道变量完整细节的情况下也能继续进一步的编译。变量声明只在编译时有它的意义，在程序连接时编译器需要实际的变量声明。

#### 变量的作用域

作用域是程序的一个区域，一般来说有三个地方可以定义变量：

- 在函数或一个代码块内部声明的变量，称为**局部变量**
- 在函数参数的定义中声明的变量，称为**形式参数**
- 在所有函数外部声明的变量，称为**全局变量**

#### 局部变量

在函数或一个代码块内部声明的变量，称为局部变量。它们只能被函数内部或者代码块内部的语句使用。

#### 全局变量

在所有函数外部定义的变量（通常是在程序的头部），称为全局变量。全局变量的值在程序的整个生命周期内都是有效的。

全局变量可以被任何函数访问。也就是说，全局变量一旦声明，在整个程序中都是可用的。

局部变量和全局变量的名称可以相同，但是在函数内，局部变量的值会覆盖全局变量的值

#### 初始化局部变量和全局变量

定义局部变量时，需要用户自行进行初始化

定义全局变量时，系统会自动初始化以下值：

![image-20220501113919214](C:\Users\10428\AppData\Roaming\Typora\typora-user-images\image-20220501113919214.png)

正确初始化变量是个好习惯，否则有时候会产生意想不到的结果。

### 2.3 常量类型

常量是固定值，在程序执行期间不会改变。这些固定的值，又叫做**字面量**。

常量可以是任何的基本数据类型，可分为整型数字、浮点数字、字符、字符串和布尔值。

常量就像是常规的变量，只不过常量的值在定义后不能进行修改。

**定义方法：**

1. 使用 **#define** 预处理器

   ```
   #define identifier value
   ```

2. 使用 **const** 关键字

   ```
   const type variable = value;
   ```

注：把常量定义为大写字母形式是一个好的习惯

### 2.4 修饰符类型

C++ 允许在 **char、int 和 double** 数据类型前放置修饰符。修饰符用于改变基本类型的含义，以满足不同的内存需求。有：

- signed
- unsigned
- long
- short

 **signed、unsigned、long 和 short** 可应用于整型，**signed** 和 **unsigned** 可应用于字符型，**long** 可应用于双精度型。

**类型限定符**：

类型限定符提供了变量的额外信息

![image-20220501143736070](C:\Users\10428\AppData\Roaming\Typora\typora-user-images\image-20220501143736070.png)



### 2.5 存储类

存储类定义 C++ 程序中变量/函数的范围（可见性）和生命周期。放置在它们所修饰类型之前，有：

- auto 
- register
- static
- extern
- mutable
- thread_local(c++11)

从 C++ 17 开始，auto 关键字不再是 C++ 存储类说明符，且 register 关键字被弃用。

**auto**

自C++11以来，auto作用：

1. 声明变量是根据初始化表达式自动推断变量类型（有点python味道了）

2. 声明函数时函数返回值的占位符

**register**

register 存储类用于定义存储在寄存器中而不是 RAM 中的局部变量。这意味着变量的最大尺寸等于寄存器的大小

寄存器只用于**需要快速访问**的变量，比如计数器。还应注意的是，定义 'register' 并不意味着变量将被存储在寄存器中，它意味着变量可能存储在寄存器中，这取决于硬件和实现的限制。

**static**

static 存储类指示编译器在程序的生命周期内保持局部变量的存在，而不需要在每次它进入和离开作用域时进行创建和销毁。故使用 static 修饰局部变量可以在函数调用之间保持局部变量的值

static 修饰符也可以应用于全局变量。当 static 修饰全局变量时，会使变量的作用域限制在声明它的文件内。

**extern**

extern 存储类用于提供一个全局变量的引用，全局变量对所有的程序文件都是可见的。当您使用 'extern' 时，对于无法初始化的变量，会把变量名指向一个之前定义过的存储位置。

当您有多个文件且定义了一个可以在其他文件中使用的全局变量或函数时，可以在其他文件中使用 *extern* 来得到已定义的变量或函数的引用。可以这么理解，*extern* 是用来在另一个文件中声明一个全局变量或函数。

extern 修饰符通常用于当有两个或多个文件共享相同的全局变量或函数的时候。



## 三、运算符

运算符是一种告诉编译器执行特定的数学或逻辑操作的符号，有：

- 算术运算符
- 关系预算符
- 逻辑预算符
- 位预算符
- 赋值运算符
- 杂项运算符

以上大多数和python基本一致，不同下面单独提出。

**位运算符**

位运算符作用于位，并逐位执行操作。&、 | 和 ^ 的真值表如下所示：

| 运算符 | 描述                                       |
| ------ | ------------------------------------------ |
| &      | 按位与                                     |
| \|     | 按位或                                     |
| ^      | 按位异或                                   |
| ~      | 按位取反                                   |
| <<     | 二进制左移(左边的二进制位丢弃，右边补0)    |
| >>     | 二进制右移(正数左补0，负数左补1，右边丢弃) |

**杂项运算符**

![image-20220501155850467](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501155850467.png)



## 四、执行控制

### 4.1 循环

**类型**

大致有以下四种类型：

![image-20220501160438754](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501160438754.png)

**循环控制**

满足某条件时需要提前突出循环

![image-20220501160639339](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501160639339.png)

**无限循环**

1. 使用for语句

  ```
for( ; ; )
{
}
  ```

### 4.2 判断

![image-20220501160928487](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501160928487.png)

## 五、函数

函数是一组一起执行一个任务的语句。每个 C++ 程序都至少有一个函数，即主函数 **main()** ，所有简单的程序都可以定义其他额外的函数。

函数**声明**告诉编译器函数的名称、返回类型和参数。函数**定义**提供了函数的实际主体。

C++ 标准库提供了大量的程序可以调用的内置函数。例如，函数 **strcat()** 用来连接两个字符串，函数 **memcpy()** 用来复制内存到另一个位置。

函数还有很多叫法，比如方法、子例程或程序，等等。

### 5.1 定义函数

常见形式：

```
return_type function_name( parameter list )
{
   body of the function
}
```

- 返回类型：一个函数可以返回一个值，return_type 是函数的返回值类型。有些函数不需要返回值，则return_type  是关键字void
- 函数名称：不能用关键字
- 参数：参数就像是占位符。当函数被调用时，您向参数传递一个值，这个值被称为实际参数。参数列表包括函数参数的类型、顺序、数量。参数是可选的，也就是说，函数可能不包含参数。

### 5.2 函数声明

函数**声明**会告诉编译器函数名称及如何调用函数。函数的实际主体可以单独定义。

具体写法如下：

```
return_type function_name(parameter list);
```

在函数声明中，参数的名称并不重要，只有参数的类型是必需的，因此下面也是有效的声明:

```
int max(int, int);
```

当您在一个源文件中定义函数且在另一个文件中调用函数时，函数声明是**必需的**。在这种情况下，您应该在**调用函数**的文件顶部声明函数。

### 5.3 调用函数

创建 C++ 函数时，会定义函数做什么，然后通过调用函数来完成已定义的任务。

当程序调用函数时，程序控制权会转移给被调用的函数。被调用的函数执行已定义的任务，当函数的返回语句被执行时，或到达函数的结束括号时，会把程序控制权交还给主程序。

### 5.4 函数参数

如果函数要使用参数，就必须声明接收参数的变量，即形式参数。

形式参数就像函数内部的其他变量，在进入函数时被创建，退出函数时被销毁。

当调用函数时，有三种向函数传递参数的方式：

![image-20220501162854085](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501162854085.png)

swap(a, b)这个函数很好说明了，传值调用与指针调用的区别，前者不会改变实际参数，而后者会。所以之前用python写swap()函数值就是换不过就是在这原因，而python 一般数值可以用  a, b = b, a 这种简洁写法，但对于numpy数组以及tensor这种第三方包的数据类型就不支持了。

### 5.5 参数默认值

当您定义一个函数，您可以为参数列表中后边的每一个参数指定默认值。当调用函数时，如果实际参数的值留空，则使用这个默认值。

### 5.6 Lambda 函数与表达式

Lambda 表达式把函数看作对象。Lambda 表达式可以像对象一样使用，比如可以将它们赋给变量和作为参数传递，还可以像函数一样对其求值。

```
[capture](parameters)->return-type{body}
```

例如：

```
[](int x, int y){ return x < y ; }
```

## 六、数据结构

### 6.1  数组

C++ 支持**数组**数据结构，它可以存储一个固定大小的相同类型元素的顺序集合。

所有的数组都是由连续的内存位置组成。最低的地址对应第一个元素，最高的地址对应最后一个元素。

**声明数组**

声明一个数组，需要指定元素的类型和元素的数量，如：

```
type arrayName[ arraySize ];
```

这叫做一维数组。**arraySize** 必须是一个大于零的整数常量，**type** 可以是任意有效的 C++ 数据类型, 如：

```
double balance[10];
```

**初始化数组**

可以逐个初始化数组，也可以使用一个初始化语句。

```
double balance[5] = {1000.0, 2.0, 3.4, 7.0, 50.0};
```

大括号 { } 之间的值的数目不能大于我们在数组声明时在方括号 [ ] 中指定的元素数目。当然也可以省去，像

```
double balance[] = {1000.0, 2.0, 3.4, 7.0, 50.0};
```

也可以通过所以为某个元素赋值, 前提数组已经声明过了，

```
balance[4] = 50.0;
```

**访问数组元素**

数组元素可以通过数组名称加索引进行访问。元素的索引是放在方括号内，跟在数组名称的后边。如：

```
double salary = balance[4]
```

还有多维数组、指针数组，后续用到再补充。。。。

### 6.2 字符串

c++ 提供以下两种字符串的表示形式：

- C风格字符串
- C++ 引入string 类类型

**C风格字符串**

C 风格的字符串起源于 C 语言，并在 C++ 中继续得到支持。字符串实际上是使用 **null** 字符 **\0** 终止的一维字符数组。

定义写法：

```
char site[] = "RUNOOB";
```

实际内存表示：

![image-20220501205858773](https://raw.githubusercontent.com/kongyan66/Img-for-md/master/img/image-20220501205858773.png)

您不需要把 **null** 字符放在字符串常量的末尾。C++ 编译器会在初始化数组时，自动把 **\0** 放在字符串的末尾。

**C++中String类**

C++ 标准库提供了 **string** 类类型，支持字符串的复制、连接、长度、比较等操作。

定义写法：

```
#include <string>
string str = "google";
```

